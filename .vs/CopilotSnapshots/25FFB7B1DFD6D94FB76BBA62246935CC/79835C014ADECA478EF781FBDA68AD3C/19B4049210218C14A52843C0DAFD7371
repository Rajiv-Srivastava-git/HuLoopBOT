
using HuLoopBOT.Services;
using HuLoopBOT.Utilities;

namespace HuLoopBOT;

public partial class MainForm : Form
{
    public MainForm()
    {
        InitializeComponent();
        lblAdminStatus.Text = AdminService.IsAdmin() ? "Running as Admin" : "Not Admin";
        lblAdminStatus.ForeColor = AdminService.IsAdmin() ? Color.Green : Color.Red;
    }

    private void btnDisableSleep_Click(object sender, EventArgs e)
        => Logger.Log(new PowerService().DisableSleep().Message);

    private void btnDisableLock_Click(object sender, EventArgs e)
        => Logger.Log(new LockService().DisableLockScreen().Message);

    private void btnPreventRdpTimeout_Click(object sender, EventArgs e)
        => Logger.Log(new RdpService().PreventTimeout().Message);

    private void btnTransferSession_Click(object sender, EventArgs e)
        => Logger.Log(new SessionTransferService().Transfer(1).Message);
}
