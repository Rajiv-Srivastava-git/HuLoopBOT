using HuLoopBOT.Models;
using HuLoopBOT.Utilities;
using System.Diagnostics;

namespace HuLoopBOT.Services;

public class PowerService
{
    public OperationResult DisableSleep()
    {
        try
        {
            Logger.LogVerbose("Starting DisableSleep operation");
            Logger.LogVerbose("Executing: powercfg /change standby-timeout-ac 0");

            var startInfo = new ProcessStartInfo
            {
                FileName = "powercfg",
                Arguments = "/change standby-timeout-ac 0",
                UseShellExecute = false,
                CreateNoWindow = true,
                WindowStyle = ProcessWindowStyle.Hidden
            };

            Process.Start(startInfo);

            Logger.LogInformation("Sleep disabled successfully");
            Logger.LogVerbose("DisableSleep operation completed");

            return OperationResult.Ok("Sleep disabled");
        }
        catch (Exception ex)
        {
            Logger.LogError("Failed to disable sleep", ex);
            return OperationResult.Fail($"Failed to disable sleep: {ex.Message}");
        }
    }
}
