
using HuLoopBOT.Models;
using Microsoft.Win32;
using HuLoopBOT.Utilities;

namespace HuLoopBOT.Services;

public class RdpService
{
    public OperationResult PreventTimeout()
    {
        Registry.SetValue(
            @"HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services",
            "MaxIdleTime", 0);
        Logger.Log("RDP timeout disabled");
        return OperationResult.Ok("RDP timeout disabled");
    }
}
