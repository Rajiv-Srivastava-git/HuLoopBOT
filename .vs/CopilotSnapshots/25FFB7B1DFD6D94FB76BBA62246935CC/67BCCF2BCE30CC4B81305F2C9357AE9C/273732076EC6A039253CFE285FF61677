using HuLoopBOT.Models;
using Microsoft.Win32;
using HuLoopBOT.Utilities;

namespace HuLoopBOT.Services;

public class LockService
{
    public OperationResult DisableLockScreen()
    {
        try
        {
            var registryPath = @"HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization";
            var valueName = "NoLockScreen";

            Logger.LogVerbose($"Starting DisableLockScreen operation");
            Logger.LogVerbose($"Registry path: {registryPath}");
            Logger.LogVerbose($"Setting {valueName} = 1");

            Registry.SetValue(registryPath, valueName, 1);

            Logger.LogInformation("Lock screen disabled successfully");
            Logger.LogVerbose("DisableLockScreen operation completed");

            return OperationResult.Ok("Lock screen disabled");
        }
        catch (Exception ex)
        {
            Logger.LogError("Failed to disable lock screen", ex);
            return OperationResult.Fail($"Failed to disable lock screen: {ex.Message}");
        }
    }
}
